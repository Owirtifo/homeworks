## Домашнее задание к занятию "6.6. Troubleshooting"

1. Выполним запрос на вывод всех активных операций, которые выполняются более 3 минут:
```
db.currentOp(
   {
     "active" : true,
	 "secs_running" : { "$gt" : 180 }
   }
)
```

Узнав номер процесса, завершим его работу:

    db.killOp(<opId>)
	
Для решения проблемы с долгими (зависающими) запросами в MongoDB можно написать скрипт, где с помощью метода db.currentOp (), будут возвращаться зависшие запросы, а затем с помощью db.killOp() завершать их и добавить его в CRON.

2. Из-за увеличения истекших ключей более 25%, Redis начинает блокировать операции записи, чтобы снизить до 25%. Для решения этой проблемы обычно делают кластер Redis, который работает от двух нод. Таким образом когда одна нода находится в блокировке, вторая нода может временно на себя взять запросы. Либо увеличить значение переменной ACTIVE_EXPIRE_CYCLE_LOOKUPS_PER_LOOP. 

3. Большое количество строк отправляется как часть одного запроса. Увеличить значение параметра net_read_timeout для завершения передачи данных.

4. Из-за нехватки памяти вызывается OOM Killer, который завершает процесс PostgreSQL. Для решения проблемы устанавливаем для vm.overcommit_memory значение 2 и vm.swappiness значение 1.